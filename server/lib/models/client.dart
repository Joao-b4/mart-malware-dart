import 'dart:io';
import 'dart:typed_data';
import 'package:server/server.dart';

class Client{
  Socket _socket;
  String _address;
  int _port;

  Client(Socket sock) {_init(sock);} 

  void _init(Socket sockClient){
    this._socket = sockClient;
    this._address = this._socket.remoteAddress.address;
    this._port = this._socket.remotePort;
    this._socketListenClient();
  }

  void _socketListenClient(){
      this._socket.listen(
        _messageHandler);
  }

  void _messageHandler(List data){
    String message = new String.fromCharCodes(Iterable.castFrom(data)).trim();
    print(message);
    this._write("TesteP2");
    this._destroyClient();
  }

  void _write(String message){
    this._socket.write(message);
  }

  void _destroyClient(){
    print("Destroy Client ${_address}");
    this._socket.destroy();
  }
}