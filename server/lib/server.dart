import 'dart:io';
import 'dart:async';
import 'package:server/models/client.dart';

class Server {
  ServerSocket serverSocket;
  String ip;
  int port;

  Server(this.ip, this.port);

  listen(Function cbDataHandler, Function catchError) {
    ServerSocket.bind(ip, port).then((ServerSocket server) {
      serverSocket = server;
      serverSocket.listen(
        cbDataHandler,
        onError: _errorHandler,
        onDone: _successfulHandler,
        cancelOnError: true,
      );
    }).catchError(catchError);
  }

  _errorHandler(dynamic errorObject, StackTrace stackError) =>
      print("Error -> ${errorObject.toString}");

  _successfulHandler() => print("Finish Connect!");
}
