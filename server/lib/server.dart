import 'dart:io';
import 'dart:async';
import 'package:server/models/client.dart';

class Server {
  ServerSocket serverSocket;
  String ip;
  int port;

  Server(this.ip, this.port);

  listen(Function cbDataHandler) {
    ServerSocket.bind(ip, port).then((ServerSocket server) {
      serverSocket = server;

      print(
          "Server listen: ${serverSocket.address.address}:${serverSocket.port}");
      serverSocket.listen(
        cbDataHandler,
        onError: _errorHandler,
        onDone: _successfulHandler,
        cancelOnError: false,
      );
    });
  }

  _errorHandler(dynamic errorObject, StackTrace stackError) =>
      print("Error -> ${errorObject.toString}");

  _successfulHandler() => print("Finish Connect!");
}
