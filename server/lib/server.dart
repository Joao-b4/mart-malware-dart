import 'dart:io';
import 'dart:async';
import 'package:server/models/client.dart';

class Server {
  static ServerSocket serverSocket;

  static listen(Function cbDataHandler) {
    ServerSocket.bind("127.0.0.1", 6661).then((ServerSocket server) {
      serverSocket = server;
      print(
          "Server listen: ${serverSocket.address.address}:${serverSocket.port}");
      print("""
                    __       
              _____/* |     ____    
                   `-,`-._,'---'
                      `, `)--` 
                      __)/ 
                       /|`
      """);
      serverSocket.listen(
        cbDataHandler,
        onError: _errorHandler,
        onDone: _successfulHandler,
        cancelOnError: false,
      );
    });
  }

  static void _errorHandler(dynamic errorObject, StackTrace stackError) =>
      print("Error -> ${errorObject.toString}");

  static void _successfulHandler() => print("Finish Connect!");
}
