import 'dart:io';
import 'dart:async';

import 'dart:typed_data';

Socket socket;

void connect(){
  Socket.connect("localhost", 6661).then((Socket sock) {
   socket = sock;
   socket.listen(_dataHandler, 
      onError: _errorHandler, 
      onDone: _successfulHandler, 
      cancelOnError: false);
   }).catchError((dynamic e) {
      print("Unable to connect: ${e.toString()}");
   });
    stdin.listen((data) => socket.write(new String.fromCharCodes(data).trim() + '\n\r'));

}

void _dataHandler(Uint8List data){
   print(new String.fromCharCodes(data).trim());
}

void _errorHandler(dynamic errorObject, StackTrace stackError)
 => print("Error -> ${errorObject.toString}");

void _successfulHandler() => print("Done Connect!");