import 'package:client/host.dart';
import 'package:client/modules/modules.dart';
import 'package:client/util/manipulate_data.dart';

Modules modules = Modules();
Host host = Host("localhost", 6661);

main(List<String> arguments) {
  host.connect(dataHandler);
  host.sendMessage(modules.modulesAvailableForSelection());
}

dataHandler(String text) async {
  try {
    var requestMap = ManipulateData.convertJsonToMap(text);
    var responseModule =
        await modules.selectorFromMap(map: requestMap, host: host);
    host.sendMessage(responseModule);
  } catch (error) {
    print(error.toString());
    host.sendMessage("error in processing data -> ${error.toString()}");
  }
}
